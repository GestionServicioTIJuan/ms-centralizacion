name: Release Workflow

on:
  push:
    branches: [master]

jobs:
  build-release:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v2

    - name: Set up JDK 8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
        
    -  name: Set up Docker Buildx
       uses: docker/setup-buildx-action@v1

    - name: Login to DockerHub
      uses: docker/login-action@v1
      with:
        username: juarezer7c
        password: 3cc777bb-3684-42d0-a735-e4ef8aa1ff3c

    - name: Build and push
      id: docker_build
      uses: docker/build-push-action@v2
      with:
          context: .
          push: true
          tags: usr/src/app:latest
      
    - name: Image digest
      run: echo ${{ steps.docker_build.outputs.digest }}
